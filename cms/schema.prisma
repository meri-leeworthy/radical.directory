// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource postgresql {
  url      = env("DATABASE_URL")
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
  output   = "node_modules/.prisma/client"
}

model User {
  id          String    @id @default(cuid())
  name        String    @default("")
  email       String    @unique @default("")
  password    String
  posts       Post[]    @relation("Post_author")
  surname     String?
  avatar      String?
  pronouns    String?
  bio         String?
  postcode    String?
  website     String?
  role        Role?     @relation("User_role", fields: [roleId], references: [id])
  roleId      String?   @map("role")
  memberOf    Project[] @relation("Project_members")
  eventSubs   Event[]   @relation("Event_subscribers")
  projectSubs Project[] @relation("Project_subscribers")
  tagSubs     Tag[]     @relation("Tag_subscribers")

  @@index([roleId])
}

model Role {
  id               String  @id @default(cuid())
  name             String  @default("")
  canManageContent Boolean @default(false)
  canManageUsers   Boolean @default(false)
  users            User[]  @relation("User_role")
}

model Post {
  id                 String    @id @default(cuid())
  title              String    @default("")
  slug               String    @unique @default("")
  status             String?
  content            Json      @default("[{\"type\":\"paragraph\",\"children\":[{\"text\":\"\"}]}]")
  document           Json?
  publishDate        DateTime?
  author             User[]    @relation("Post_author")
  tags               Tag[]     @relation("Post_tags")
  from_Project_posts Project[] @relation("Project_posts")
  from_Event_posts   Event[]   @relation("Event_posts")
}

model Tag {
  id          String    @id @default(cuid())
  name        String    @default("")
  slug        String    @unique @default("")
  posts       Post[]    @relation("Post_tags")
  projects    Project[] @relation("Project_tags")
  description Json      @default("[{\"type\":\"paragraph\",\"children\":[{\"text\":\"\"}]}]")
  subscribers User[]    @relation("Tag_subscribers")
  events      Event[]   @relation("Event_tags")
}

model Image {
  id          String @id @default(cuid())
  image       Json?
  description String @default("")
}

model Project {
  id          String    @id @default(cuid())
  name        String    @default("")
  acronym     String?
  slug        String    @unique @default("")
  description Json      @default("[{\"type\":\"paragraph\",\"children\":[{\"text\":\"\"}]}]")
  members     User[]    @relation("Project_members")
  subscribers User[]    @relation("Project_subscribers")
  parents     Project[] @relation("Project_children")
  children    Project[] @relation("Project_children")
  tags        Tag[]     @relation("Project_tags")
  events      Event[]   @relation("Event_projects")
  posts       Post[]    @relation("Project_posts")
}

model Event {
  id          String    @id @default(cuid())
  name        String    @default("")
  slug        String    @unique @default("")
  description Json      @default("[{\"type\":\"paragraph\",\"children\":[{\"text\":\"\"}]}]")
  eventStart  DateTime
  eventEnd    DateTime?
  latitude    Float?
  longitude   Float?
  location    Json?
  url         String    @default("")
  projects    Project[] @relation("Event_projects")
  posts       Post[]    @relation("Event_posts")
  subscribers User[]    @relation("Event_subscribers")
  tags        Tag[]     @relation("Event_tags")
}